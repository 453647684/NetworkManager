<?xml version="1.0" encoding="UTF-8" ?>

<node name="/" xmlns:tp="http://telepathy.freedesktop.org/wiki/DbusSpec#extensions-v0">

    <interface name="org.freedesktop.NetworkManager.SecretAgent.CaptivePortal">
        <tp:docstring>
            Private D-Bus interface used by NetworkManager and secret agents to
            handle manual and automatic login to a captive portal.
        </tp:docstring>

        <method name="Authenticate">
            <tp:docstring>
                Authenticate to a captive portal.
            </tp:docstring>
            <annotation name="org.freedesktop.DBus.GLib.CSymbol" value="impl_secret_agent_portal_authenticate"/>
            <annotation name="org.freedesktop.DBus.GLib.Async" value=""/>
            <arg name="request_id" type="u" direction="in">
                <tp:docstring>
                    A unique ID for this portal authentication request.  If the
                    request is canceled this ID will be given to the agent via
                    the CancelAuthenticate method.
                </tp:docstring>
            </arg>
            <arg name="connection" type="a{sa{sv}}" direction="in" tp:type="String_String_Variant_Map_Map">
                <tp:docstring>
                    Nested settings maps containing the connection for which
                    secrets are being requested.  This may contain system-owned
                    secrets if the agent has successfully authenticated to
                    modify system network settings.
                </tp:docstring>
            </arg>
            <arg name="connection_path" type="o" direction="in">
                <tp:docstring>
                    Object path of the connection for which secrets are being
                    requested.
                </tp:docstring>
            </arg>
            <arg name="device_path" type="o" direction="in">
                <tp:docstring>
                    Object path of the network device this portal was detected
                    on.
                </tp:docstring>
            </arg>
            <arg name="url" type="s" direction="in">
                <tp:docstring>
                    The URL of the captive portal if available.  If the URL is
                    not given, the agent should load a generic website which
                    will trigger a portal login page.
                </tp:docstring>
            </arg>
            <arg name="details" type="a{sv}" direction="in">
                <tp:docstring>
                    Dict of additional portal details, if any.  Possible keys
                    include 'ifindex' (interface index number of the network
                    device the portal was detected on) and 'iface' (interface
                    name of the network device the portal was detected on).
                </tp:docstring>
            </arg>

            <!-- Values returned by the agent -->
            <arg name="result" type="u" direction="out" tp:type="NM_SECRET_AGENT_PORTAL_RESULT">
                <tp:docstring>
                    Result of the portal authentication operation.
                </tp:docstring>
            </arg>
            <arg name="result" type="u" direction="out" tp:type="NM_SECRET_AGENT_PORTAL_RESULT">
                <tp:docstring>
                    Result of the portal authentication operation.
                </tp:docstring>
            </arg>
        </method>

        <tp:enum name="NM_SECRET_AGENT_PORTAL_RESULT" type="u">
          <tp:enumvalue suffix="UNKNOWN" value="0">
            <tp:docstring>
              This result is unused.  If returned by the agent, it will be
              treated as FAILURE.
            </tp:docstring>
          </tp:enumvalue>
          <tp:enumvalue suffix="FAILURE" value="1">
            <tp:docstring>
              Portal authentication failed and the connection should be
              disconnected.
            </tp:docstring>
          </tp:enumvalue>
          <tp:enumvalue suffix="MAYBE" value="2">
            <tp:docstring>
              Portal authentication was performed but success is uncertain and
              no definite failure was determined.
            </tp:docstring>
          </tp:enumvalue>
          <tp:enumvalue suffix="SUCCESS" value="3">
            <tp:docstring>
              Portal authentication definitely succeeded.
            </tp:docstring>
          </tp:enumvalue>
        </tp:enum>

        <method name="CancelAuthenticate">
            <tp:docstring>
                Cancel a pending Authenticate request.
            </tp:docstring>
            <annotation name="org.freedesktop.DBus.GLib.CSymbol" value="impl_secret_agent_portal_cancel"/>
            <annotation name="org.freedesktop.DBus.GLib.Async" value=""/>
            <arg name="request_id" type="u" direction="in">
                <tp:docstring>
                    An Authenticate request ID for which authentication should
                    be canceled.
                </tp:docstring>
            </arg>
            <arg name="connection_path" type="o" direction="in">
                <tp:docstring>
                    Object path of the connection for which, if secrets are being
                    requested, the request should be canceled.
                </tp:docstring>
            </arg>
        </method>

    </interface>

</node>
