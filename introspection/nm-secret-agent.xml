<?xml version="1.0" encoding="UTF-8" ?>

<node name="/" xmlns:tp="http://telepathy.freedesktop.org/wiki/DbusSpec#extensions-v0">

    <interface name="org.freedesktop.NetworkManager.SecretAgent">
        <tp:docstring>
            Private D-Bus interface used by secret agents that store and provide
            secrets to NetworkManager.
        </tp:docstring>

        <method name="GetSecrets">
            <tp:docstring>
                Retrieve and return stored secrets, if any, or request new
                secrets from the agent's user.
            </tp:docstring>
            <annotation name="org.freedesktop.DBus.GLib.CSymbol" value="impl_secret_agent_get_secrets"/>
            <annotation name="org.freedesktop.DBus.GLib.Async" value=""/>
            <arg name="connection" type="a{sa{sv}}" direction="out" tp:type="String_String_Variant_Map_Map">
                <tp:docstring>
                    Nested settings maps containing the connection for which
                    secrets are being requested.
                </tp:docstring>
            </arg>
            <arg name="connection_path" type="o" direction="in">
                <tp:docstring>
                    Object path of the connection for which secrets are being
                    requested.
                </tp:docstring>
            </arg>
            <arg name="setting_name" type="s" direction="in">
                <tp:docstring>
                    Setting name for which secrets are being requested.
                </tp:docstring>
            </arg>
            <arg name="hints" type="as" direction="in">
                <tp:docstring>
                    Array of strings of key names in the requested setting for
                    which NetworkManager thinks a secrets may be required.  The
                    Agent should return any secrets it has, or that it thinks
                    are required, regardless of what hints NetworkManager sends
                    in this request.
                </tp:docstring>
            </arg>
            <arg name="request_new" type="b" direction="in">
                <tp:docstring>
                    If true, new secrets are assumed to be invalid or incorrect,
                    and the agent should ask the user for new secrets.  If false,
                    existing secrets should be retrieved from storage and 
                    returned without interrupting the user.
                </tp:docstring>
            </arg>

            <arg name="secrets" type="a{sa{sv}}" direction="out" tp:type="String_String_Variant_Map_Map">
                <tp:docstring>
                    Nested settings maps containing secrets.  Each setting MUST
                    contain at least the 'name' field, containing the name of
                    the setting, and one or more secrets.
                </tp:docstring>
            </arg>
        </method>

        <method name="SaveSecrets">
            <tp:docstring>
                Save given secrets to backing storage.
            </tp:docstring>
            <annotation name="org.freedesktop.DBus.GLib.CSymbol" value="impl_secret_agent_save_secrets"/>
            <annotation name="org.freedesktop.DBus.GLib.Async" value=""/>
            <arg name="connection" type="a{sa{sv}}" direction="out" tp:type="String_String_Variant_Map_Map">
                <tp:docstring>
                    Nested settings maps containing the entire connection
                    (including secrets), for which the agent should save the
                    secrets to backing storage.
                </tp:docstring>
            </arg>
            <arg name="connection_path" type="o" direction="in">
                <tp:docstring>
                    Object path of the connection for which the agent should
                    save secrets to backing storage.
                </tp:docstring>
            </arg>
        </method>

        <method name="DeleteSecrets">
            <tp:docstring>
                Delete secrets from backing storage.
            </tp:docstring>
            <annotation name="org.freedesktop.DBus.GLib.CSymbol" value="impl_secret_agent_delete_secrets"/>
            <annotation name="org.freedesktop.DBus.GLib.Async" value=""/>
            <arg name="connection" type="a{sa{sv}}" direction="out" tp:type="String_String_Variant_Map_Map">
                <tp:docstring>
                    Nested settings maps containing the entire connection
                    (including secrets), for which the agent should delete the
                    secrets from backing storage.
                </tp:docstring>
            </arg>
            <arg name="connection_path" type="o" direction="in">
                <tp:docstring>
                    Object path of the connection for which the agent should
                    delete secrets from backing storage.
                </tp:docstring>
            </arg>
        </method>

    </interface>

</node>
